# Stratos Brain: Comprehensive Codebase Review

**Author:** Manus AI
**Date:** January 10, 2026

## 1. Introduction

The Stratos Brain project is a sophisticated, production-grade financial analysis platform designed to identify and analyze trading signals in the cryptocurrency and equity markets. It combines a robust data ingestion and processing pipeline, AI-powered analysis, and a modern web-based dashboard to deliver actionable insights to users. This document provides a comprehensive review of the entire Stratos Brain codebase, including the frontend, backend, database, edge functions, and automated workflows.

## 2. High-Level Architecture

The project follows a modern, decoupled architecture, which provides excellent scalability, flexibility, and security. The main components are:

- **Frontend Dashboard:** A React-based single-page application (SPA) for user interaction, data visualization, and analysis.
- **Backend Signal Engine:** A Python-based worker that ingests data, calculates features, and runs the AI analysis pipeline.
- **Supabase:** The core of the backend, providing a PostgreSQL database, authentication, and serverless Edge Functions.
- **GitHub Actions:** For orchestrating the daily data ingestion and processing workflows.
- **Vercel:** For hosting and deploying the frontend dashboard.

```
┌─────────────────────────────────────────────────────────────────┐
│                        STRATOS BRAIN                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐ │
│  │  Dashboard  │───▶│ Edge Func   │───▶│    Supabase DB      │ │
│  │   (React)   │    │ Control API │    │                     │ │
│  └─────────────┘    └─────────────┘    │  • assets           │ │
│                                        │  • daily_features   │ │
│  ┌─────────────┐    ┌─────────────┐    │  • daily_signal_    │ │
│  │  pg_cron    │───▶│   pgmq      │    │    facts            │ │
│  │ (scheduler) │    │  (queue)    │    │  • signal_instances │ │
│  └─────────────┘    └──────┬──────┘    │  • engine_configs   │ │
│                            │           │  • engine_jobs      │ │
│                            ▼           └─────────────────────┘ │
│                     ┌─────────────┐              ▲              │
│                     │   Python    │──────────────┘              │
│                     │   Worker    │                             │
│                     │ (GCP/Docker)│                             │
│                     └─────────────┘                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 3. Frontend (React Dashboard)

The frontend is a well-structured and modern web application built with React, TypeScript, and Tailwind CSS. It provides a responsive and user-friendly interface for exploring the vast amount of data generated by the backend.

### 3.1. Technology Stack

| Category          | Technology                                      |
| ----------------- | ----------------------------------------------- |
| Framework         | React 18                                        |
| Language          | TypeScript                                      |
| Styling           | Tailwind CSS                                    |
| UI Components     | shadcn/ui, Radix UI                             |
| Routing           | wouter                                          |
| Data Fetching     | SWR                                             |
| Charting          | Recharts, TradingView Lightweight Charts        |
| Build Tool        | Vite                                            |

### 3.2. Key Components and Structure

The frontend code is located in the `dashboard/client` directory. The main components are:

- **`App.tsx`:** The main entry point, which sets up the routing and global providers (Theme, Auth, Tooltip).
- **`DashboardLayout.tsx`:** The main layout of the dashboard, including the header, navigation, and status bar.
- **`Home.tsx`:** The main page, which acts as a container for the different asset tables (Watchlist, All Assets, etc.) and the Asset Detail view.
- **`CustomizableAssetTable.tsx`:** A reusable data table for displaying lists of assets with customizable columns.
- **`AssetDetail.tsx`:** A detailed view of a single asset, including a chart, AI analysis, trade plan, and notes.
- **`ChatSidebar.tsx`:** A chat interface that allows users to interact with an AI assistant.

### 3.3. Data Fetching and State Management

The application uses a combination of `useSWR` for data fetching and component-level state (`useState`, `useEffect`) for managing the UI state. This is a simple and effective approach for an application of this complexity. The `useDashboardData.ts` hook provides a good example of how data is fetched for the main asset tables.

### 3.4. Routing

Routing is handled by the `wouter` library, which is a minimalist and hook-based routing solution for React. The routing logic in `App.tsx` is straightforward and easy to follow.

## 4. Backend (Python Signal Engine)

The backend is a powerful and sophisticated data processing pipeline written in Python. It is responsible for ingesting data, calculating a wide range of technical indicators, and generating AI-powered analysis.

### 4.1. Pipeline Architecture

The core of the backend is the `worker.py`, which consumes jobs from a pgmq queue in the Supabase database. The pipeline is divided into several stages, each with a specific responsibility:

- **Stage 1 (Fetch & Evaluate):** Fetches the latest data and evaluates signal templates.
- **Stage 2 (AI):** Runs the initial AI analysis.
- **Stage 3 (State):** Manages the state of signal instances.
- **Stage 4 (Scoring):** Scores the signals based on various factors.
- **Stage 5 (AI Review):** Performs a two-pass AI-powered chart review for assets surfaced on the dashboard.

### 4.2. AI-Powered Analysis

The project makes extensive use of AI, particularly Google's Gemini models, for analysis. The `stage5_ai_review.py` is a key component, performing a two-pass analysis:

- **Pass A:** An independent chart score based on OHLCV data.
- **Pass B:** A reconciliation pass that compares the Pass A output with the engine's scores and signals.

This two-pass approach is a sophisticated way to combine the strengths of both the AI model and the rule-based signal engine.

## 5. Supabase Integration

Supabase is the backbone of the Stratos Brain project, providing the database, authentication, and serverless functions.

### 5.1. Database Schema

The database schema is well-designed and normalized. The use of views (e.g., `v_dashboard_all_assets`, `v_active_signals`) to simplify data access for the frontend is a good practice. The migrations in `supabase/migrations` provide a clear history of the schema's evolution.

### 5.2. Edge Functions

The project leverages Supabase Edge Functions to create a secure and scalable API for the frontend. The key functions are:

- **`control-api`:** The main API for the dashboard, providing data for the asset tables, asset details, and other UI components.
- **`company-chat-api`:** Powers the company research chat, using Gemini with function calling to access both internal data and external web search.
- **`generate-document`:** Generates investment memos and one-pagers using Gemini, grounded with data from the `control-api` and web search.

## 6. Workflows and Automation

The project uses GitHub Actions for CI/CD and to orchestrate the daily data ingestion and processing workflows. The workflows are well-structured and make good use of features like dependency caching and concurrency controls.

## 7. Deployment

The project is deployed to Vercel (frontend) and Docker (backend worker), which is a standard and effective setup for this type of application.

## 8. Summary and Recommendations

Overall, the Stratos Brain project is a powerful and well-engineered financial analysis platform. The codebase is clean, well-structured, and follows modern development best practices. The use of a decoupled architecture, a sophisticated data processing pipeline, and AI-powered analysis makes it a truly impressive system.

**Recommendations:**

*   **Expand Data Sources:** Consider adding more data sources, such as on-chain data for cryptocurrencies or fundamental data for equities.
*   **Enhance AI Models:** Continue to refine and improve the AI models to provide even more accurate and insightful analysis.
*   **Add More Dashboard Features:** Consider adding new features to the dashboard, such as backtesting capabilities or social sentiment analysis.
*   **Improve Documentation:** While the existing documentation is good, it could be further improved with more detailed explanations of the data processing pipeline and AI models.

I have now completed the comprehensive review of the Stratos Brain codebase. I am ready to discuss the new features you would like to implement.
